<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel='stylesheet' href='/css/styles.css'/>
    <title>Especificaciones competencia</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
    <script>

        document.addEventListener("DOMContentLoaded", () => {
            let skill = localStorage.getItem('actSkill');

            if (skill) {

                skill = JSON.parse(skill);

                let skillText = skill.text.replace(/\n/g, ' ');
                document.getElementById('skilltxt').innerHTML = '<strong>Skill:' + skillText + '</strong>';
                document.getElementById('skillDesc').innerText = 'space for the description of the skill: ' + skill.description;

                const svg = document.createElementNS('http://www.w3.org/2000/svg', "svg");
                svg.setAttribute("width", "100");
                svg.setAttribute("height", "100");
                svg.setAttribute("viewBox", "0 0 100 100");

                const polygon = document.createElementNS('http://www.w3.org/2000/svg', "polygon");
                polygon.setAttribute("points", "50,5 95,27.5 95,72.5 50,95 5,72.5 5,27.5");
                polygon.classList.add("hexagon");

                const text = document.createElementNS('http://www.w3.org/2000/svg', "text");
                text.setAttribute("x", "50%");
                text.setAttribute("y", "20%");
                text.setAttribute("text-anchor", "middle");
                text.setAttribute("fill", "black");
                text.setAttribute("font-size", "10");

                const words = skillText.split(' ');
                let line = '';
                skillText = [];

                words.forEach(word => {
                    if ((line + word).length > 10) {
                        skillText.push(line.trim());
                        line = '';
                    }
                    line += `${word} `;
                });

                skillText.forEach((line, index) => {
                    const tspan = document.createElementNS("http://www.w3.org/2000/svg", "tspan");
                    tspan.setAttribute("x", "50%");
                    tspan.setAttribute("dy", index ? "1.2em" : "1em");
                    tspan.setAttribute("font-weight", "bold");
                    tspan.textContent = line;
                    text.appendChild(tspan);
                });

                const image = document.createElementNS('http://www.w3.org/2000/svg', "image");
                image.setAttribute("x", "35%");
                image.setAttribute("y", "60%");
                image.setAttribute("width", "30");
                image.setAttribute("height", "30");
                image.setAttribute('href', `${skill.icon}`);

                svg.appendChild(polygon);
                svg.appendChild(text);
                svg.appendChild(image);
                document.getElementById('skillImage').replaceWith(svg);

            }

            let checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const allChecked = Array.from(checkboxes).every(cb => cb.checked);

                    if (allChecked) {
                        confetti({
                            particleCount: 250,
                            spread: 100,
                            origin: {y: 0.6}
                        });
                        document.getElementById('evidenceForm').style.display = 'block';
                        document.getElementById('evidenceTitle').style.display = 'block';
                        document.getElementById('evidenceInput').style.display = 'block';
                        document.getElementById('evidenceButton').style.display = 'block';
                    }
                });
            });

            window.addEventListener('unload', () => {
                localStorage.clear();
            });
        });

    </script>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<div class="header">
<h1 id="skilltxt"></h1>
</div>

<div class="container">
<div class="row">
    <div class="col-md-3">
        <img id="skillImage" src="" alt="Skill Icon" style="width: 100px; height: 100px;">
    </div>

    <div class="col-md-9">
        <h3><strong>Skill Score: 1 points</strong></h3>
        <h3 style="text-align: center"><strong>Description</strong></h3>
        <p style="text-align: center" id="skillDesc">space for the description of the skill</p>

        <h3><strong>Tasks to Complete</strong></h3>
        <div>
        <input type="checkbox" id="skillTask1" name="skillTask1" unchecked/>
        <label for="skillTask1">Task 1</label>
        </div>
        <div>
        <input type="checkbox" id="skillTask2" name="skillTask2" unchecked/>
        <label for ="skillTask2">Task 2</label>
        </div>

        <h3><strong>Resources</strong></h3>
        <ul id="skillResources">
            <li>space for resources</li>
        </ul>

        <h3 id="evidenceTitle" style="display: none"><strong>Provide evidence</strong></h3>
        <form id="evidenceForm" style="display: none"></form>
        <textarea id="evidenceInput" class="form-control" rows="5" style="display: none" name="evidenceForm" placeholder="Enter a URL or explanation as evidence for completing the skill"></textarea>
        <br>
            <button id="evidenceButton" type="submit" style="display: none" class='btn btn-success' >Submit</button>
    </div>
</div>
</div>

</body>
</html>